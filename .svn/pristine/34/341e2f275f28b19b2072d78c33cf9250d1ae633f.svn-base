package Dialogos;

import Conexion.ExeSql;
import Formularios.fmMain;
import PanelForm.pfGastosSueldos;
import java.io.IOException;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.logging.Level;
import java.util.logging.Logger;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;

/**
 *
 * @author informatica (Roberto Lopez)
 */
public class jdBuscaSii extends javax.swing.JDialog {
   
    public static String rango1,rango21,rango22,rango31,rango32,rango41,rango42,rango51,rango52,rango61,rango62,rango71,rango72,rango81 = "";
    public static String srango1,srango21,srango22,srango31,srango32,srango41,srango42,srango51,srango52,srango61,srango62,srango71,srango72,srango81 = "";
    public static double drango1,drango21,drango22,drango31,drango32,drango41,drango42,drango51,drango52,drango61,drango62,drango71,drango72,drango81 = 0.0;
    public static String fact2,fact3,fact4,fact5,fact6,fact7,fact8 = "";
    public static String sfact2,sfact3,sfact4,sfact5,sfact6,sfact7,sfact8 = "";
    public static double dfact2,dfact3,dfact4,dfact5,dfact6,dfact7,dfact8 = 0.0;
    public static String dif2,dif3,dif4,dif5,dif6,dif7,dif8 = "";
    public static String sdif2,sdif3,sdif4,sdif5,sdif6,sdif7,sdif8 = "";
    public static double ddif2,ddif3,ddif4,ddif5,ddif6,ddif7,ddif8 = 0.0;
    
    public static int iagno2 = 0;
    public static int imes2 = 0;
    public static int cont = 1;
    
    public static double valor = 0;
    public static String nombre, codigo = "";
   
    public jdBuscaSii() throws IOException{
       
//         if (pfGastosSueldos.imes == 0){
//           
//            imes2 = 12;
//            iagno2 = pfGastosSueldos.iagno-1;
//            
//         }else if (pfGastosSueldos.imes > 0){
//         
//           imes2 = pfGastosSueldos.imes;
//           iagno2 = pfGastosSueldos.iagno;
//         }
//        
      
         
//      Document doc2 = org.jsoup.Jsoup.connect("http://www.biblionet.cl/tablas/tablas_v2/iu.asp?Req_Ano="+iagno2+"&Req_Mes="+imes2).get();
//    
//      
//        Elements filas2 = doc2.select("tr");
//         
//        for(Element fila2 :filas2){
//            
//            Elements columna2 = fila2.select("td");
//            
////            for (Element columna2:columnas2){
//                         
//                   if (cont == 7){
//
//                       rango1 = columna2.text().substring(11,22);    
//                   }         
//                   
//                   if (cont == 8){
//                          rango21 = columna2.text().substring(0,10);    
//                          rango22 = columna2.text().substring(10,24);
//                          fact2 = columna2.text().substring(25,29);
//                          dif2 = columna2.text().substring(29,39);       
//                   }
//                   
//                   if (cont == 9){
//                           rango31 = columna2.text().substring(0,12);    
//                           rango32 = columna2.text().substring(12,26);    
//                           fact3 = columna2.text().substring(26,30);  
//                           dif3 = columna2.text().substring(30,40);     
//                   }    
//                   
//                   if (cont == 10){
//                     
//                        rango41 = columna2.text().substring(0,12);    
//                        rango42 = columna2.text().substring(13,25);    
//                        fact4 = columna2.text().substring(26,31);   
//                        dif4 = columna2.text().substring(32,42);   
//                   
//                    }   
//                    
//                    if (cont == 11){
//                     
//                        rango51 = columna2.text().substring(0,12);    
//                        rango52 = columna2.text().substring(13,25);    
//                        fact5 = columna2.text().substring(26,30);   
//                        dif5 = columna2.text().substring(31,41);   
//                   
//                    }       
//                    
//                    if (cont == 12){
//                     
//                        rango61 = columna2.text().substring(0,12);    
//                        rango62 = columna2.text().substring(13,25);    
//                        fact6 = columna2.text().substring(26,31);   
//                        dif6 = columna2.text().substring(32,42);  
//                                           
//                    }  
//                    
//                    if (cont == 13){
//                     
//                        rango71 = columna2.text().substring(0,12);    
//                        rango72 = columna2.text().substring(13,26);    
//                        fact7 = columna2.text().substring(27,31);   
//                        dif7 = columna2.text().substring(32,44);   
//                    }  
//                    
//                    
//                    if (cont == 14){
//                     
//                        rango81 = columna2.text().substring(0,13);    
//                        fact8 = columna2.text().substring(20,24);   
//                        dif8 = columna2.text().substring(24,36);   
//                    }       
//               
//                cont++;
//
//        }
//        
//        if (rango1 == null){
//        
//           return;
//        
//        }
//         
//        srango1 = rango1.replaceAll("\\.","");
//        drango1 = Double.parseDouble(srango1.replaceAll("\\,", "."));
//       
//        srango21 = rango21.replaceAll("\\.","");       
//        drango21 = Double.parseDouble(srango21.replaceAll("\\,", "."));
//         
//        srango22 = rango22.replaceAll("\\.","");
//        drango22 = Double.parseDouble(srango22.replaceAll("\\,", "."));
//        
//        srango31 = rango31.replaceAll("\\.","");
//        drango31 = Double.parseDouble(srango31.replaceAll("\\,", "."));
//
//        
//        srango32 = rango32.replaceAll("\\.","");
//        drango32 = Double.parseDouble(srango32.replaceAll("\\,", "."));
//        
//        srango41 = rango41.replaceAll("\\.","");
//        drango41 = Double.parseDouble(srango41.replaceAll("\\,", "."));
//        
//        srango42 = rango42.replaceAll("\\.","");
//        drango42 = Double.parseDouble(srango42.replaceAll("\\,", "."));
//        
//        srango51 = rango51.replaceAll("\\.","");
//        drango51 = Double.parseDouble(srango51.replaceAll("\\,", "."));
//        
//        srango52 = rango52.replaceAll("\\.","");
//        drango52 = Double.parseDouble(srango52.replaceAll("\\,", "."));
//        
//        srango61 = rango61.replaceAll("\\.","");
//        drango61 = Double.parseDouble(srango61.replaceAll("\\,", "."));
//        
//        srango62 = rango62.replaceAll("\\.","");
//        drango62 = Double.parseDouble(srango62.replaceAll("\\,", "."));
//       
//        srango71 = rango71.replaceAll("\\.","");
//        drango71 = Double.parseDouble(srango71.replaceAll("\\,", "."));
//        
//        srango72 = rango72.replaceAll("\\.","");
//        drango72 = Double.parseDouble(srango72.replaceAll("\\,", "."));
//        
//        srango81 = rango81.replaceAll("\\.","");
//        drango81 = Double.parseDouble(srango81.replaceAll("\\,", "."));
//        
//        
//        sdif2 = dif2.replaceAll("\\.","");
//        ddif2 = Double.parseDouble(sdif2.replaceAll("\\,", "."));
//          
//        sdif3 = dif3.replaceAll("\\.","");
//        ddif3 = Double.parseDouble(sdif3.replaceAll("\\,", "."));
//        
//        sdif4 = dif4.replaceAll("\\.","");
//        ddif4 = Double.parseDouble(sdif4.replaceAll("\\,", "."));
//        
//        sdif5 = dif5.replaceAll("\\.","");
//        ddif5 = Double.parseDouble(sdif5.replaceAll("\\,", "."));
//        
//        sdif6 = dif6.replaceAll("\\.","");
//        ddif6 = Double.parseDouble(sdif6.replaceAll("\\,", "."));
//        
//        sdif7 = dif7.replaceAll("\\.","");
//        ddif7 = Double.parseDouble(sdif7.replaceAll("\\,", "."));    
//        
//        sdif8 = dif8.replaceAll("\\.","");
//        ddif8 = Double.parseDouble(sdif8.replaceAll("\\,", "."));    
//        
//        
//        sfact2 = fact2.replaceAll("\\,", ".");
//        dfact2 = Double.parseDouble(sfact2);
//        
//        sfact3 = fact3.replaceAll("\\,", ".");
//        dfact3 = Double.parseDouble(sfact3);
//        
//        sfact4 = fact4.replaceAll("\\,", ".");
//        dfact4 = Double.parseDouble(sfact4);
//        
//        sfact5 = fact5.replaceAll("\\,", ".");
//        dfact5 = Double.parseDouble(sfact5);
//        
//        sfact6 = fact6.replaceAll("\\,", ".");
//        dfact6 = Double.parseDouble(sfact6);
//        
//        sfact7 = fact7.replaceAll("\\,", ".");
//        dfact7 = Double.parseDouble(sfact7);
//        
//        sfact8 = fact8.replaceAll("\\,", ".");
//        dfact8 = Double.parseDouble(sfact8);
       
//        System.out.print(""+drango1+"\n\n");
//       
//        System.out.print(""+drango21+"\n");
//        System.out.print(""+drango22+"\n");
//        System.out.print(""+dfact2+"\n");
//        System.out.print(""+ddif2+"\n\n\n");
////        
//        System.out.print(""+drango31+"\n");
//        System.out.print(""+drango32+"\n");
//        System.out.print(""+dfact3+"\n");
//        System.out.print(""+ddif3+"\n\n\n");
//       
//        System.out.print(""+drango41+"\n");
//        System.out.print(""+drango42+"\n");
//        System.out.print(""+dfact4+"\n");
//        System.out.print(""+ddif4+"\n\n\n");
//        
//        System.out.print(""+drango51+"\n");
//        System.out.print(""+drango52+"\n");
//        System.out.print(""+dfact5+"\n");
//        System.out.print(""+ddif5+"\n\n\n");
//        
//        System.out.print(""+drango61+"\n");
//        System.out.print(""+drango62+"\n");
//        System.out.print(""+dfact6+"\n");
//        System.out.print(""+ddif6+"\n\n\n");
//        
//        System.out.print(""+drango71+"\n");
//        System.out.print(""+dfact7+"\n");
//        System.out.print(""+ddif7+"\n");    
   
//******************************************************************************************************************************************///        
   
        ExeSql Sql = new ExeSql();
        ResultSet Rs = null;
        
        
        try {
            
            Rs = Sql.Select("SELECT * FROM indicadores WHERE nombre IN ('IMPUESTO_FACTOR','IMPUESTO_RANGO','IMPUESTO_REBAJA')");
            
            if(Sql.GetRowCount()>0){
                
                while (Rs.next()){
                    
                    codigo = Rs.getString("codigo");
                    nombre = Rs.getString("nombre");
                   
                    String monto = Rs.getString("valor").trim();
              
                    
                    if (codigo.equals("IMP_1_1")){
                        
                        rango1 = monto;
                    
                    }
                    
                    if (codigo.equals("IMP_2_0")){
                        
                        rango21 = monto;
                    
                    }
                    
                    if (codigo.equals("IMP_2_1")){
                    
                        rango22 = monto;
                    
                    }
                    
                    if (codigo.equals("FAC_2")){
                    
                        fact2 = monto;
                    
                    }
                    
                    if (codigo.equals("REB_2")){
                    
                        dif2 = monto;
                    
                    }
                    
                    if (codigo.equals("IMP_3_0")){
                    
                       rango31 = monto;
           
                    }
                    
                    
                    if (codigo.equals("IMP_3_1")){
                    
                        rango32 = monto;
                    
                    }
                    
                    
                    if (codigo.equals("FAC_3")){
                    
                        fact3 = monto;
                    
                    }
                    
                    if (codigo.equals("REB_3")){
                    
                       dif3 = monto;
                      
                    }
                    
                    if (codigo.equals("IMP_4_0")){
                    
                        rango41 = monto;
                    
                    }
                    
                    if (codigo.equals("IMP_4_1")){
                    
                        rango42 = monto;
                    
                    }
                    
                    if (codigo.equals("FAC_4")){
                    
                       fact4 = monto;
                    
                    }
                    
                    if (codigo.equals("REB_4")){
                    
                       dif4 = monto;
                    
                    }
                    
                    if (codigo.equals("IMP_5_0")){
                    
                        rango51 = monto;
                    
                    }
                    
                    
                    if (codigo.equals("IMP_5_1")){
                        
                        rango52 = monto;
                    }
                    
                    if (codigo.equals("FAC_5")){
                    
                        fact5 = monto;
                    
                    }
                    
                    if (codigo.equals("REB_5")){
                    
                        dif5 = monto;
                    
                    }
                    
                    if (codigo.equals("IMP_6_0")){
                    
                         rango61 = monto;
                    
                    }
                    
                    
                    if (codigo.equals("IMP_6_1")){
                    
                       rango62 = monto;
                    
                    }
                    
                    
                    if (codigo.equals("FAC_6")){
                    
                       fact6 = monto;
                    
                    }
                    
                    if (codigo.equals("REB_6")){
                    
                       dif6 = monto;
                    
                    }
                    
                    
                    if (codigo.equals("IMP_7_0")){
                    
                        rango71 = monto;
                    
                    }
                    
                    
                    if (codigo.equals("IMP_7_1")){
                     
                       rango72 = monto;
                    
                    }
                    
                    
                    if (codigo.equals("FAC_7")){
                    
                          fact7 = monto;
                    
                    }
                    if (codigo.equals("REB_7")){
                    
                        dif7 = monto;
                    
                    }
                    
                    
                    if (codigo.equals("IMP_8_0")){
                    
                      rango81 = monto;
                      
                    
                    }
                    
                    
                    if (codigo.equals("FAC_8")){
                    
                      fact8 = monto;
                       
                    
                    }
                    
                    if (codigo.equals("REB_8")){
                        
                        dif8 = monto;
                    
                    }
                
                }
            
           
                
            }
            
           
        drango1 = Double.parseDouble(rango1);
        drango21 = Double.parseDouble(rango21);
        drango22 = Double.parseDouble(rango22);
        drango31 = Double.parseDouble(rango31);
        drango32 = Double.parseDouble(rango32);
        drango41 = Double.parseDouble(rango41);
        drango42 = Double.parseDouble(rango42);
        drango51 = Double.parseDouble(rango51);
        drango52 = Double.parseDouble(rango52);
        drango61 = Double.parseDouble(rango61);
        drango62 = Double.parseDouble(rango62);
        drango71 = Double.parseDouble(rango71);
        drango72 = Double.parseDouble(rango72);
        drango81 = Double.parseDouble(rango81);
        
        
       
        ddif2 = Double.parseDouble(dif2);
        ddif3 = Double.parseDouble(dif3);
        ddif4 = Double.parseDouble(dif4);
        ddif5 = Double.parseDouble(dif5);
        ddif6 = Double.parseDouble(dif6);
        ddif7 = Double.parseDouble(dif7);    
        ddif8 = Double.parseDouble(dif8);    
      
        dfact2 = Double.parseDouble(fact2);
        dfact3 = Double.parseDouble(fact3);
        dfact4 = Double.parseDouble(fact4);
        dfact5 = Double.parseDouble(fact5);
        dfact6 = Double.parseDouble(fact6);
        dfact7 = Double.parseDouble(fact7);
        dfact8 = Double.parseDouble(fact8);
        
        
        System.out.print(""+drango1+"\n");
        
        System.out.print(""+drango21+"\n");
        System.out.print(""+drango22+"\n");
        System.out.print(""+dfact2+"\n");
        System.out.print(""+ddif2+"\n\n\n");
//        
        System.out.print(""+drango31+"\n");
        System.out.print(""+drango32+"\n");
        System.out.print(""+dfact3+"\n");
        System.out.print(""+ddif3+"\n\n\n");
       
        System.out.print(""+drango41+"\n");
        System.out.print(""+drango42+"\n");
        System.out.print(""+dfact4+"\n");
        System.out.print(""+ddif4+"\n\n\n");
        
        System.out.print(""+drango51+"\n");
        System.out.print(""+drango52+"\n");
        System.out.print(""+dfact5+"\n");
        System.out.print(""+ddif5+"\n\n\n");
        
        System.out.print(""+drango61+"\n");
        System.out.print(""+drango62+"\n");
        System.out.print(""+dfact6+"\n");
        System.out.print(""+ddif6+"\n\n\n");
        
        System.out.print(""+drango71+"\n");
        System.out.print(""+dfact7+"\n");
        System.out.print(""+ddif7+"\n");    
        
        
            
            
            
        } catch (SQLException ex) {
            Logger.getLogger(jdValores.class.getName()).log(Level.SEVERE, null, ex);
        }
        
        
        
        
        
    }
    
    
    public Double Getrango1(){
       return drango1;
        
    }
    
    public Double Getrango21(){
       return drango21;
        
    }
    
    public Double Getrango22(){
       return drango22;
        
    }
     
    public Double Getfact2(){
       return dfact2;
        
    }
     
    public Double Getdif2(){
       return ddif2;
        
    }
    
    public Double Getrango31(){
       return drango31;
        
    }
    
    public Double Getrango32(){
       return drango32;
        
    }
    
    public Double Getfact3(){
       return dfact3;
    
    }
     
    public Double Getdif3(){
       return ddif3;
        
    } 
     
    public Double Getrango41(){
       return drango41;
        
    }
    
    public Double Getrango42(){
       return drango42;
        
    }
    
    public Double Getfact4(){
       return dfact4;
    
    }
     
    public Double Getdif4(){
       return ddif4;
        
    }  
     
    public Double Getrango51(){
       return drango51;
        
    }
    
    public Double Getrango52(){
       return drango52;
        
    }
    
    public Double Getfact5(){
       return dfact5;
    
    }
     
    public Double Getdif5(){
       return ddif5;
        
    } 
    
    public Double Getrango61(){
       return drango61;
        
    }
    
    public Double Getrango62(){
       return drango62;
        
    }
    
    public Double Getfact6(){
       return dfact6;
    
    }
     
    public Double Getdif6(){
       return ddif6;
        
    } 
    
    public Double Getrango71(){
       return drango71;
        
    }
    
    public Double Getfact7(){
       return dfact7;
    
    }
     
    public Double Getdif7(){
       return ddif7;
        
    } 
    
    public Double Getrango81(){
       return drango81;
        
    }
    
    public Double Getfact8(){
       return dfact8;
    
    }
     
    public Double Getdif8(){
       return ddif8;
        
    } 
    
    
    
    
    
    public Double compara(double monto){
       double impuesto = 0; 
       @SuppressWarnings("UnusedAssignment")
       double factor = 0;
       
       if(monto <= drango1){
         
           impuesto = 0;
       
       }else if(monto >= drango21 && monto <= drango22){
           
             factor = monto * dfact2;
             impuesto = factor - ddif2;
       
       }else if(monto >= drango31 && monto <= drango32){
       
             factor = monto * dfact3;
             impuesto = factor - ddif3;
       
       }else if(monto >= drango41 && monto <= drango42){
       
             factor = monto * dfact4;
             impuesto = factor - ddif4;
       
       }else if(monto >= drango51 && monto <= drango52){
       
             factor = monto * dfact5;
             impuesto = factor - ddif5;
       
       }else if(monto >= drango61 && monto <= drango62){
       
             factor = monto * dfact6;
             impuesto = factor - ddif6;
       
       }else if(monto >= drango71 && monto <= drango72){
       
             factor = monto * dfact7;
             impuesto = factor - ddif7;
       
       }else if(monto >= drango81){
       
             factor = monto * dfact8;
             impuesto = factor - ddif8;
       
       }
        
       return impuesto;                    
        
    } 

    public static void main(String[] args)  {
       
       try {                                                                                                  //Para ejecutarlo
           jdBuscaSii sii = new jdBuscaSii();                                                   // como aplicación independienmte
          
       } catch (IOException ex) {                                                                               // desde el main()
//           Logger.getLogger(jdBuscaSii.class.getName()).log(Level.SEVERE, null, ex);                    // 
       }
    }
} 
